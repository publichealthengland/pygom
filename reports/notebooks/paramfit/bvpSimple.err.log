Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
theta = [0.0]

obj = SquareLoss(theta=theta, ode=model, x0=initialState, t0=t[0], 
                t=t[-1], y=[-2], state_name=['y0'], target_state=['y1'])

thetaHat = minimize(fun=obj.costIV, x0=[0.0])

print(thetaHat)

model.initial_values = ([0.0] + thetaHat['x'].tolist(), t[0])

solution = model.integrate(t[1::])
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mUFuncTypeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[4], line 3[0m
[1;32m      1[0m theta [38;5;241m=[39m [[38;5;241m0.0[39m]
[0;32m----> 3[0m obj [38;5;241m=[39m [43mSquareLoss[49m[43m([49m[43mtheta[49m[38;5;241;43m=[39;49m[43mtheta[49m[43m,[49m[43m [49m[43mode[49m[38;5;241;43m=[39;49m[43mmodel[49m[43m,[49m[43m [49m[43mx0[49m[38;5;241;43m=[39;49m[43minitialState[49m[43m,[49m[43m [49m[43mt0[49m[38;5;241;43m=[39;49m[43mt[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m,[49m[43m [49m
[1;32m      4[0m [43m                [49m[43mt[49m[38;5;241;43m=[39;49m[43mt[49m[43m[[49m[38;5;241;43m-[39;49m[38;5;241;43m1[39;49m[43m][49m[43m,[49m[43m [49m[43my[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;241;43m-[39;49m[38;5;241;43m2[39;49m[43m][49m[43m,[49m[43m [49m[43mstate_name[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43my0[39;49m[38;5;124;43m'[39;49m[43m][49m[43m,[49m[43m [49m[43mtarget_state[49m[38;5;241;43m=[39;49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43my1[39;49m[38;5;124;43m'[39;49m[43m][49m[43m)[49m
[1;32m      6[0m thetaHat [38;5;241m=[39m minimize(fun[38;5;241m=[39mobj[38;5;241m.[39mcostIV, x0[38;5;241m=[39m[[38;5;241m0.0[39m])
[1;32m      8[0m [38;5;28mprint[39m(thetaHat)

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/ode_loss.py:27[0m, in [0;36mSquareLoss.__init__[0;34m(self, theta, ode, x0, t0, t, y, state_name, state_weight, target_param, target_state)[0m
[1;32m     25[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, theta, ode, x0, t0, t, y, state_name,
[1;32m     26[0m              state_weight[38;5;241m=[39m[38;5;28;01mNone[39;00m, target_param[38;5;241m=[39m[38;5;28;01mNone[39;00m, target_state[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[0;32m---> 27[0m     [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m[43mtheta[49m[43m,[49m[43m [49m[43mode[49m[43m,[49m[43m [49m[43mx0[49m[43m,[49m[43m [49m[43mt0[49m[43m,[49m[43m [49m[43mt[49m[43m,[49m[43m [49m[43my[49m[43m,[49m[43m [49m[43mstate_name[49m[43m,[49m[43m [49m[43mstate_weight[49m[43m,[49m
[1;32m     28[0m [43m                     [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[43mtarget_param[49m[43m,[49m[43m [49m[43mtarget_state[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/base_loss.py:191[0m, in [0;36mBaseLoss.__init__[0;34m(self, theta, ode, x0, t0, t, y, state_name, state_weight, spread_param, target_param, target_state)[0m
[1;32m    187[0m [38;5;28mself[39m[38;5;241m.[39m_interpolateTimeIndex [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    189[0m [38;5;66;03m# TODO: optimal weight in terms of Pareto front from a[39;00m
[1;32m    190[0m [38;5;66;03m# multiobjective optimization perspective[39;00m
[0;32m--> 191[0m [38;5;28mself[39m[38;5;241m.[39m_lossObj [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_setLossType[49m[43m([49m[43m)[49m
[1;32m    193[0m [38;5;66;03m# final check[39;00m
[1;32m    194[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_t [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_y [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_stateName [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/ode_loss.py:34[0m, in [0;36mSquareLoss._setLossType[0;34m(self)[0m
[1;32m     33[0m [38;5;28;01mdef[39;00m [38;5;21m_setLossType[39m([38;5;28mself[39m):
[0;32m---> 34[0m     [38;5;28mself[39m[38;5;241m.[39m_lossObj [38;5;241m=[39m [43mSquare[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_y[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_weight[49m[43m)[49m
[1;32m     35[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_lossObj

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/loss_type.py:100[0m, in [0;36mSquare.__init__[0;34m(self, y, weights)[0m
[1;32m     98[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, y, weights[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[1;32m     99[0m     [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(y, weights)
[0;32m--> 100[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mloss[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_y[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/loss_type.py:118[0m, in [0;36mSquare.loss[0;34m(self, yhat, apply_weighting)[0m
[1;32m    102[0m [38;5;28;01mdef[39;00m [38;5;21mloss[39m([38;5;28mself[39m, yhat, apply_weighting[38;5;241m=[39m[38;5;28;01mTrue[39;00m):
[1;32m    103[0m [38;5;250m    [39m[38;5;124;03m'''[39;00m
[1;32m    104[0m [38;5;124;03m    Loss under square loss.  Not really saying much here[39;00m
[1;32m    105[0m 
[0;32m   (...)[0m
[1;32m    116[0m [38;5;124;03m    :math:`\\sum_{i=1}^{n} (y-\\hat{y})^{2}`[39;00m
[1;32m    117[0m [38;5;124;03m    '''[39;00m
[0;32m--> 118[0m     [38;5;28;01mreturn[39;00m ([38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mresidual[49m[43m([49m[43myhat[49m[43m,[49m[43m [49m[43mapply_weighting[49m[43m)[49m[38;5;241m*[39m[38;5;241m*[39m[38;5;241m2[39m)[38;5;241m.[39msum()

File [0;32m/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/pygom-0.1.dev1+g303ef5d.d20240429-py3.8-linux-x86_64.egg/pygom/loss/loss_type.py:84[0m, in [0;36mBaseloss_Type.residual[0;34m(self, yhat, apply_weighting)[0m
[1;32m     82[0m     resid [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_y [38;5;241m-[39m yhat
[1;32m     83[0m [38;5;28;01mif[39;00m apply_weighting:
[0;32m---> 84[0m     resid [38;5;241m*[39m[38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_w
[1;32m     86[0m [38;5;28;01mreturn[39;00m resid

[0;31mUFuncTypeError[0m: Cannot cast ufunc 'multiply' output from dtype('float64') to dtype('int64') with casting rule 'same_kind'

